<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Super Admin Dashboard | ICMMCS 2025</title>
	<meta name="description" content="Super Admin Dashboard for ICMMCS 2025 Conference Management">
	<link rel="shortcut icon" href="../assets/img/sponsors_logo/favicon.png" />
	
	<!-- CSS Libraries -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css" rel="stylesheet">

	<style>
		:root {
			--primary-color: #006666;
			--secondary-color: #004d4d;
			--accent-color: #019087;
			--light-bg: #f8f9fa;
			--dark-bg: #212529;
			--border-color: #dee2e6;
		}

		body {
			background-color: var(--light-bg);
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		}

		.sidebar {
			background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
			min-height: 100vh;
			padding: 0;
			position: fixed;
			top: 0;
			left: 0;
			width: 280px;
			z-index: 1000;
			transition: all 0.3s ease;
			box-shadow: 2px 0 10px rgba(0,0,0,0.1);
		}

		.sidebar.collapsed {
			width: 70px;
		}

		.sidebar-header {
			padding: 1.5rem 1rem;
			border-bottom: 1px solid rgba(255,255,255,0.1);
			background: rgba(0,0,0,0.1);
		}

		.sidebar-header h4 {
			color: white;
			margin: 0;
			font-weight: 600;
		}

		.sidebar-nav {
			padding: 1rem 0;
		}

		.nav-item {
			margin: 0.25rem 0;
		}

		.nav-link {
			color: rgba(255,255,255,0.8) !important;
			padding: 0.75rem 1rem;
			border-radius: 0;
			transition: all 0.3s ease;
			border-left: 3px solid transparent;
		}

		.nav-link:hover, .nav-link.active {
			background: rgba(255,255,255,0.1);
			color: white !important;
			border-left-color: white;
		}

		.nav-link i {
			width: 20px;
			margin-right: 0.75rem;
		}

		.main-content {
			margin-left: 280px;
			padding: 2rem;
			transition: all 0.3s ease;
		}

		.main-content.expanded {
			margin-left: 70px;
		}

		.top-navbar {
			background: white;
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
			padding: 1rem 2rem;
			margin: -2rem -2rem 2rem -2rem;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.stats-card {
			background: white;
			border-radius: 15px;
			padding: 1.5rem;
			box-shadow: 0 5px 15px rgba(0,0,0,0.08);
			transition: all 0.3s ease;
		}

		.stats-card:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0,0,0,0.15);
		}

		.stats-icon {
			width: 60px;
			height: 60px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.5rem;
			color: white;
		}

		.bg-purple {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		}

		.content-section {
			background: white;
			border-radius: 15px;
			padding: 2rem;
			margin-bottom: 2rem;
			box-shadow: 0 5px 15px rgba(0,0,0,0.08);
		}

		.section-title {
			color: var(--primary-color);
			font-weight: 600;
			margin-bottom: 1.5rem;
			padding-bottom: 0.5rem;
			border-bottom: 2px solid var(--accent-color);
		}

		.btn-primary-custom {
			background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
			border: none;
			border-radius: 8px;
			padding: 0.5rem 1.5rem;
			font-weight: 500;
			transition: all 0.3s ease;
		}

		.btn-primary-custom:hover {
			background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
			transform: translateY(-2px);
		}

		.table th {
			background-color: var(--primary-color);
			color: white;
			border: none;
			font-weight: 500;
		}

		.table-responsive {
			border-radius: 10px;
			overflow: auto;
			box-shadow: 0 3px 10px rgba(0,0,0,0.1);
		}

		.modal-header {
			background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
			color: white;
			border-radius: 15px 15px 0 0;
		}

		.badge-status {
			padding: 0.4rem 0.8rem;
			border-radius: 20px;
			font-size: 0.8rem;
			font-weight: 500;
		}

		.admin-card {
			background: white;
			border-radius: 15px;
			padding: 1.5rem;
			box-shadow: 0 5px 15px rgba(0,0,0,0.08);
			transition: all 0.3s ease;
			border-left: 4px solid var(--accent-color);
		}

		.admin-card:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0,0,0,0.15);
		}

		.loading-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0,0,0,0.5);
			display: flex;
			justify-content: center;
			align-items: center;
			z-index: 9999;
		}

		.spinner {
			border: 4px solid rgba(255,255,255,0.3);
			border-radius: 50%;
			border-top: 4px solid white;
			width: 50px;
			height: 50px;
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		.toggle-sidebar {
			background: none;
			border: none;
			color: var(--primary-color);
			font-size: 1.5rem;
			cursor: pointer;
		}

		/* Responsive Design */
		@media (max-width: 768px) {
			.sidebar {
				width: 100%;
				transform: translateX(-100%);
			}
			
			.sidebar.show {
				transform: translateX(0);
			}
			
			.main-content {
				margin-left: 0;
			}
		}

		.referral-code {
			background: var(--light-bg);
			border: 2px dashed var(--accent-color);
			border-radius: 8px;
			padding: 1rem;
			font-family: 'Courier New', monospace;
			font-weight: bold;
			text-align: center;
			position: relative;
		}

		.copy-btn {
			position: absolute;
			right: 10px;
			top: 50%;
			transform: translateY(-50%);
			background: var(--accent-color);
			color: white;
			border: none;
			border-radius: 4px;
			padding: 0.25rem 0.5rem;
			font-size: 0.8rem;
		}

		/* DataTable Responsive Improvements */
		.dataTables_wrapper {
			overflow-x: auto;
		}

		.dataTables_wrapper .dataTables_scroll {
			overflow-x: auto;
		}

		.dataTables_wrapper .dataTables_scrollBody {
			overflow-x: auto;
			overflow-y: auto;
		}

		/* Mobile responsive table */
		@media (max-width: 768px) {
			.table-responsive {
				font-size: 0.85rem;
			}
			
			.btn-group .btn {
				padding: 0.25rem 0.5rem;
				font-size: 0.75rem;
			}
			
			.dataTables_wrapper .dataTables_length,
			.dataTables_wrapper .dataTables_filter,
			.dataTables_wrapper .dataTables_info,
			.dataTables_wrapper .dataTables_paginate {
				font-size: 0.85rem;
			}
		}

		/* Improve table cell content */
		.table td {
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			max-width: 200px;
		}

		.table td.text-wrap {
			white-space: normal;
		}

		/* Better button group spacing */
		.btn-group .btn {
			margin: 0 1px;
		}

		/* Responsive priority classes */
		@media (max-width: 576px) {
			.d-sm-none { display: none !important; }
		}

		@media (max-width: 768px) {
			.d-md-none { display: none !important; }
		}

		@media (max-width: 992px) {
			.d-lg-none { display: none !important; }
		}

		@media (max-width: 1200px) {
			.d-xl-none { display: none !important; }
		}
	</style>
</head>

<body>
	<!-- Loading Overlay -->
	<div id="loadingOverlay" class="loading-overlay d-none">
		<div class="spinner"></div>
	</div>

	<!-- Sidebar -->
	<nav class="sidebar" id="sidebar">
		<div class="sidebar-header">
			<h4><i class="fas fa-crown me-2"></i>Super Admin</h4>
		</div>
		<ul class="navbar-nav sidebar-nav">
			<li class="nav-item">
				<a class="nav-link active" href="#" onclick="showSection('dashboard')">
					<i class="fas fa-tachometer-alt"></i>Dashboard
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('admins')">
					<i class="fas fa-user-shield"></i>Admin Management
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('registrations')">
					<i class="fas fa-users"></i>Registrations
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('speakers')">
					<i class="fas fa-microphone"></i>Presenters
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('keynote-speakers')">
					<i class="fas fa-star"></i>Keynote Speakers
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('sponsors')">
					<i class="fas fa-handshake"></i>Sponsors
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('reviewing-committee')">
					<i class="fas fa-users-cog"></i>Reviewing Committee
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="#" onclick="showSection('analytics')">
					<i class="fas fa-chart-bar"></i>Analytics
				</a>
			</li>
		</ul>
	</nav>

	<!-- Main Content -->
	<main class="main-content" id="mainContent">
		<!-- Top Navigation -->
		<div class="top-navbar">
			<div>
				<button class="toggle-sidebar" onclick="toggleSidebar()">
					<i class="fas fa-bars"></i>
				</button>
				<span class="ms-3 fw-bold text-dark">ICMMCS 2025 Super Admin Panel</span>
			</div>
			<div class="d-flex align-items-center">
				<span class="me-3 text-muted">Welcome, Super Admin</span>
				<button class="btn btn-outline-danger btn-sm" onclick="logout()">
					<i class="fas fa-sign-out-alt me-1"></i>Logout
				</button>
			</div>
		</div>

		<!-- Dashboard Section -->
		<div id="dashboardSection" class="content-section">
			<h2 class="section-title">Dashboard Overview</h2>
			<div class="row" id="statsContainer">
				<!-- Stats cards will be dynamically loaded -->
			</div>
			
			<div class="mt-4">
				<h4>Recent Activity</h4>
				<div class="table-responsive">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>Action</th>
								<th>Entity</th>
								<th>Details</th>
								<th>Timestamp</th>
							</tr>
						</thead>
						<tbody id="recentActivity">
							<!-- Recent activity will be loaded here -->
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<!-- Admin Management Section -->
		<div id="adminsSection" class="content-section d-none">
			<h2 class="section-title">Admin Management</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#createAdminModal">
					<i class="fas fa-plus me-2"></i>Create New Admin
				</button>
				<button class="btn btn-success" onclick="exportAdmins()">
					<i class="fas fa-download me-2"></i>Export Admins
				</button>
			</div>
			<div class="row" id="adminsContainer">
				<!-- Admin cards will be loaded here -->
			</div>
		</div>

		<!-- Registrations Section -->
		<div id="registrationsSection" class="content-section d-none">
			<h2 class="section-title">Conference Registrations</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-success" onclick="exportData('registrations')">
						<i class="fas fa-download me-2"></i>Export CSV
					</button>
					<select class="form-select" style="width: auto;" onchange="filterRegistrations(this.value)">
						<option value="all">All Registrations</option>
						<option value="paid">Paid Only</option>
						<option value="pending">Pending Payment</option>
					</select>
				</div>
				<div class="d-flex align-items-center">
					<span class="me-2">Total:</span>
					<span class="badge bg-primary" id="registrationsCount">0</span>
				</div>
			</div>
			<div class="table-responsive">
				<table id="registrationsTable" class="table table-hover" style="width: 100%;">
					<thead>
						<tr>
							<th style="min-width: 60px;">ID</th>
							<th style="min-width: 150px;">Name</th>
							<th style="min-width: 180px;">Email</th>
							<th style="min-width: 120px;">Type</th>
							<th style="min-width: 100px;">Fee</th>
							<th style="min-width: 100px;">Status</th>
							<th style="min-width: 150px;">Referred By</th>
							<th style="min-width: 120px;">Date</th>
							<th style="min-width: 120px;">Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<!-- Speakers Section -->
		<div id="speakersSection" class="content-section d-none">
			<h2 class="section-title">Conference Presenters</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-success" onclick="exportData('speakers')">
						<i class="fas fa-download me-2"></i>Export CSV
					</button>
				</div>
				<div class="d-flex align-items-center">
					<span class="me-2">Total:</span>
					<span class="badge bg-primary" id="speakersCount">0</span>
				</div>
			</div>
			<div class="table-responsive">
				<table id="speakersTable" class="table table-hover" style="width: 100%;">
					<thead>
						<tr>
							<th style="min-width: 200px;">Paper</th>
							<th style="min-width: 120px;">Name</th>
							<th style="min-width: 150px;">Email</th>
							<th style="min-width: 150px;">Institution</th>
							<th style="min-width: 200px;">Paper Title</th>
							<th style="min-width: 100px;">Country</th>
							<th style="min-width: 120px;">Referred By</th>
							<th style="min-width: 100px;">Date</th>
							<th style="min-width: 100px;">Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<!-- Keynote Speakers Section -->
		<div id="keynoteSpeakersSection" class="content-section d-none">
			<h2 class="section-title">Conference Keynote Speakers</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-success" onclick="exportData('keynote-speakers')">
						<i class="fas fa-download me-2"></i>Export CSV
					</button>
				</div>
				<div class="d-flex align-items-center">
					<span class="me-2">Total:</span>
					<span class="badge bg-primary" id="keynoteSpeakersCount">0</span>
				</div>
			</div>
			<div class="table-responsive">
				<table id="keynoteSpeakersTable" class="table table-hover">
					<thead>
						<tr>
							<th>Name</th>
							<th>Email</th>
							<th>Institution</th>
							<th>Keynote Title</th>
							<th>Status</th>
							<th>Registered</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<!-- Sponsors Section -->
		<div id="sponsorsSection" class="content-section d-none">
			<h2 class="section-title">Conference Sponsors</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-success" onclick="exportData('sponsors')">
						<i class="fas fa-download me-2"></i>Export CSV
					</button>
				</div>
				<div class="d-flex align-items-center">
					<span class="me-2">Total:</span>
					<span class="badge bg-primary" id="sponsorsCount">0</span>
				</div>
			</div>
			<div class="table-responsive">
				<table id="sponsorsTable" class="table table-hover">
					<thead>
						<tr>
							<th>ID</th>
							<th>Organization</th>
							<th>Contact Name</th>
							<th>Email</th>
							<th>Phone</th>
							<th>Package</th>
							<th>Date</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<!-- Reviewing Committee Section -->
		<div id="reviewingCommitteeSection" class="content-section d-none">
			<h2 class="section-title">Reviewing Committee Management</h2>
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#createCommitteeModal">
						<i class="fas fa-plus me-2"></i>Add Committee Member
					</button>
					<button class="btn btn-success" onclick="exportCommitteeMembers()">
						<i class="fas fa-download me-2"></i>Export CSV
					</button>
				</div>
				<div class="d-flex align-items-center gap-3">
					<span class="me-2">Active Members:</span>
					<span class="badge bg-success" id="activeCommitteeCount">0</span>
					<span class="me-2">Total:</span>
					<span class="badge bg-primary" id="totalCommitteeCount">0</span>
				</div>
			</div>

			<!-- Committee Stats Cards -->
			<div class="row mb-4">
				<div class="col-md-3">
					<div class="stats-card">
						<div class="d-flex align-items-center">
							<div class="stats-icon bg-primary">
								<i class="fas fa-users"></i>
							</div>
							<div class="ms-3">
								<h3 class="mb-0" id="statsActiveMembers">0</h3>
								<p class="text-muted mb-0">Active Members</p>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-3">
					<div class="stats-card">
						<div class="d-flex align-items-center">
							<div class="stats-icon bg-warning">
								<i class="fas fa-clock"></i>
							</div>
							<div class="ms-3">
								<h3 class="mb-0" id="statsPendingSpeakers">0</h3>
								<p class="text-muted mb-0">Pending Reviews</p>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-3">
					<div class="stats-card">
						<div class="d-flex align-items-center">
							<div class="stats-icon bg-info">
								<i class="fas fa-eye"></i>
							</div>
							<div class="ms-3">
								<h3 class="mb-0" id="statsUnderReview">0</h3>
								<p class="text-muted mb-0">Under Review</p>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-3">
					<div class="stats-card">
						<div class="d-flex align-items-center">
							<div class="stats-icon bg-success">
								<i class="fas fa-check"></i>
							</div>
							<div class="ms-3">
								<h3 class="mb-0" id="statsApproved">0</h3>
								<p class="text-muted mb-0">Approved</p>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="table-responsive">
				<table id="committeeTable" class="table table-hover">
					<thead>
						<tr>
							<th>Name</th>
							<th>Email</th>
							<th>Designation</th>
							<th>Institution</th>
							<th>Expertise</th>
							<th>Status</th>
							<th>Created</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<!-- Analytics Section -->
		<div id="analyticsSection" class="content-section d-none">
			<h2 class="section-title">Analytics & Reports</h2>
			<div class="row">
				<div class="col-md-6">
					<div class="card">
						<div class="card-header bg-primary text-white">
							<h5>Registration Trends</h5>
						</div>
						<div class="card-body">
							<canvas id="registrationChart" width="400" height="200"></canvas>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="card">
						<div class="card-header bg-success text-white">
							<h5>Revenue Breakdown</h5>
						</div>
						<div class="card-body">
							<canvas id="revenueChart" width="400" height="200"></canvas>
						</div>
					</div>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-12">
					<div class="card">
						<div class="card-header bg-info text-white">
							<h5>Referral Performance</h5>
						</div>
						<div class="card-body">
							<div id="referralStats">
								<!-- Referral statistics will be loaded here -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- Create Admin Modal -->
	<div class="modal fade" id="createAdminModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Create New Admin</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="createAdminForm">
						<div class="mb-3">
							<label for="adminEmail" class="form-label">Email Address</label>
							<input type="email" class="form-control" id="adminEmail" required>
						</div>
						<div class="mb-3">
							<label for="adminPassword" class="form-label">Password</label>
							<input type="password" class="form-control" id="adminPassword" required>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="createAdmin()">
						<i class="fas fa-save me-2"></i>Create Admin
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Registration Modal -->
	<div class="modal fade" id="editRegistrationModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Registration</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editRegistrationForm">
						<input type="hidden" id="editRegId">
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegName" class="form-label">Name</label>
									<input type="text" class="form-control" id="editRegName" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegEmail" class="form-label">Email</label>
									<input type="email" class="form-control" id="editRegEmail" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegPhone" class="form-label">Phone</label>
									<input type="tel" class="form-control" id="editRegPhone">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegType" class="form-label">Registration Type</label>
									<input type="text" class="form-control" id="editRegType">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegInstitution" class="form-label">Institution</label>
									<input type="text" class="form-control" id="editRegInstitution">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegCountry" class="form-label">Country</label>
									<input type="text" class="form-control" id="editRegCountry">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegFee" class="form-label">Registration Fee</label>
									<input type="text" class="form-control" id="editRegFee">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editRegStatus" class="form-label">Payment Status</label>
									<select class="form-select" id="editRegStatus">
										<option value="false">Pending</option>
										<option value="true">Paid</option>
									</select>
								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateRegistration()">
						<i class="fas fa-save me-2"></i>Save Changes
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Speaker Modal -->
	<div class="modal fade" id="editSpeakerModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Speaker</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editSpeakerForm" enctype="multipart/form-data">
						<input type="hidden" id="editSpeakerId">
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSpeakerName" class="form-label">Name</label>
									<input type="text" class="form-control" id="editSpeakerName" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSpeakerEmail" class="form-label">Email</label>
									<input type="email" class="form-control" id="editSpeakerEmail" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSpeakerInstitution" class="form-label">Institution</label>
									<input type="text" class="form-control" id="editSpeakerInstitution">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSpeakerCountry" class="form-label">Country</label>
									<input type="text" class="form-control" id="editSpeakerCountry">
								</div>
							</div>
						</div>
						<div class="mb-3">
							<label for="editSpeakerPaperTitle" class="form-label">Paper Title</label>
							<input type="text" class="form-control" id="editSpeakerPaperTitle">
						</div>
						<div class="mb-3">
							<label for="editSpeakerPhone" class="form-label">Phone</label>
							<input type="tel" class="form-control" id="editSpeakerPhone">
						</div>
						<div class="mb-3">
							<label class="form-label">Current Paper File</label>
							<div class="mb-2" id="currentFileDisplay">
								<!-- Current file link will be displayed here -->
							</div>
						</div>
						<div class="mb-3">
							<label for="editSpeakerFile" class="form-label">Upload New Paper (Optional)</label>
																	<input type="file" class="form-control" id="editSpeakerFile" name="fileInput" accept=".pdf,.docx,.tex,.latex">
							<small class="text-muted">Leave empty to keep current file. Supported formats: PDF, DOCX, LaTeX (.tex, .latex)</small>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateSpeaker()">
						<i class="fas fa-save me-2"></i>Save Changes
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Keynote Speaker Modal -->
	<div class="modal fade" id="editKeynoteSpeakerModal" tabindex="-1">
		<div class="modal-dialog modal-xl">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Keynote Speaker</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editKeynoteSpeakerForm">
						<input type="hidden" id="editKeynoteSpeakerId">
						
						<!-- Personal Information -->
						<h6 class="text-primary mb-3"><i class="fas fa-user me-2"></i>Personal Information</h6>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerName" class="form-label">Full Name *</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerName" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerEmail" class="form-label">Email *</label>
									<input type="email" class="form-control" id="editKeynoteSpeakerEmail" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerPhone" class="form-label">Phone</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerPhone">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerCountry" class="form-label">Country</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerCountry">
								</div>
							</div>
						</div>

						<!-- Professional Information -->
						<h6 class="text-primary mb-3 mt-4"><i class="fas fa-briefcase me-2"></i>Professional Information</h6>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerDesignation" class="form-label">Designation</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerDesignation">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerInstitution" class="form-label">Institution</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerInstitution">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerExperience" class="form-label">Experience Years</label>
									<input type="number" class="form-control" id="editKeynoteSpeakerExperience">
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editKeynoteSpeakerSpecialization" class="form-label">Specialization</label>
									<input type="text" class="form-control" id="editKeynoteSpeakerSpecialization">
								</div>
							</div>
						</div>

						<!-- Keynote Details -->
						<h6 class="text-primary mb-3 mt-4"><i class="fas fa-microphone me-2"></i>Keynote Details</h6>
						<div class="mb-3">
							<label for="editKeynoteSpeakerTitle" class="form-label">Keynote Title</label>
							<input type="text" class="form-control" id="editKeynoteSpeakerTitle">
						</div>
						<div class="mb-3">
							<label for="editKeynoteSpeakerAbstract" class="form-label">Abstract</label>
							<textarea class="form-control" id="editKeynoteSpeakerAbstract" rows="4"></textarea>
						</div>
						
						<!-- Status -->
						<h6 class="text-primary mb-3 mt-4"><i class="fas fa-flag me-2"></i>Status</h6>
						<div class="mb-3">
							<label for="editKeynoteSpeakerStatus" class="form-label">Status</label>
							<select class="form-control" id="editKeynoteSpeakerStatus">
								<option value="PENDING">Pending</option>
								<option value="UNDER_REVIEW">Under Review</option>
								<option value="APPROVED">Approved</option>
								<option value="REJECTED">Rejected</option>
								<option value="CONFIRMED">Confirmed</option>
							</select>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateKeynoteSpeaker()">
						<i class="fas fa-save me-2"></i>Save Changes
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Sponsor Modal -->
	<div class="modal fade" id="editSponsorModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Sponsor</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editSponsorForm">
						<input type="hidden" id="editSponsorId">
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSponsorOrganization" class="form-label">Organization</label>
									<input type="text" class="form-control" id="editSponsorOrganization" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSponsorContactName" class="form-label">Contact Name</label>
									<input type="text" class="form-control" id="editSponsorContactName" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSponsorEmail" class="form-label">Email</label>
									<input type="email" class="form-control" id="editSponsorEmail" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editSponsorPhone" class="form-label">Phone</label>
									<input type="tel" class="form-control" id="editSponsorPhone">
								</div>
							</div>
						</div>
						<div class="mb-3">
							<label for="editSponsorPackage" class="form-label">Sponsorship Package</label>
							<input type="text" class="form-control" id="editSponsorPackage">
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateSponsor()">
						<i class="fas fa-save me-2"></i>Save Changes
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Create Committee Member Modal -->
	<div class="modal fade" id="createCommitteeModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Add Committee Member</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="createCommitteeForm">
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="committeeName" class="form-label">Full Name *</label>
									<input type="text" class="form-control" id="committeeName" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="committeeEmail" class="form-label">Email *</label>
									<input type="email" class="form-control" id="committeeEmail" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="committeeDesignation" class="form-label">Designation *</label>
									<input type="text" class="form-control" id="committeeDesignation" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="committeePhone" class="form-label">Phone</label>
									<input type="tel" class="form-control" id="committeePhone">
								</div>
							</div>
						</div>
						<div class="mb-3">
							<label for="committeeInstitution" class="form-label">Institution *</label>
							<input type="text" class="form-control" id="committeeInstitution" required>
						</div>
						<div class="mb-3">
							<label for="committeeExpertise" class="form-label">Expertise Area *</label>
							<textarea class="form-control" id="committeeExpertise" rows="2" required placeholder="e.g., Machine Learning, Data Science, Mathematics, Computer Science"></textarea>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="createCommitteeMember()">
						<i class="fas fa-save me-2"></i>Add Member
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Committee Member Modal -->
	<div class="modal fade" id="editCommitteeModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Committee Member</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editCommitteeForm">
						<input type="hidden" id="editCommitteeId">
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editCommitteeName" class="form-label">Full Name *</label>
									<input type="text" class="form-control" id="editCommitteeName" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editCommitteeEmail" class="form-label">Email *</label>
									<input type="email" class="form-control" id="editCommitteeEmail" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editCommitteeDesignation" class="form-label">Designation *</label>
									<input type="text" class="form-control" id="editCommitteeDesignation" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="mb-3">
									<label for="editCommitteePhone" class="form-label">Phone</label>
									<input type="tel" class="form-control" id="editCommitteePhone">
								</div>
							</div>
						</div>
						<div class="mb-3">
							<label for="editCommitteeInstitution" class="form-label">Institution *</label>
							<input type="text" class="form-control" id="editCommitteeInstitution" required>
						</div>
						<div class="mb-3">
							<label for="editCommitteeExpertise" class="form-label">Expertise Area *</label>
							<textarea class="form-control" id="editCommitteeExpertise" rows="2" required></textarea>
						</div>
						<div class="mb-3">
							<label for="editCommitteeStatus" class="form-label">Status</label>
							<select class="form-control" id="editCommitteeStatus">
								<option value="true">Active</option>
								<option value="false">Inactive</option>
							</select>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateCommitteeMember()">
						<i class="fas fa-save me-2"></i>Save Changes
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Send to Committee Modal -->
	<div class="modal fade" id="sendToCommitteeModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-users-cog me-2"></i>Send Speaker to Reviewing Committee</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<input type="hidden" id="sendToCommitteeSpeakerId">
					
					<div class="alert alert-info">
						<i class="fas fa-info-circle me-2"></i>
						<strong>Speaker:</strong> <span id="speakerNameDisplay"></span><br>
						<strong>Paper Title:</strong> <span id="paperTitleDisplay"></span>
					</div>

					<div class="mb-3">
						<label class="form-label">Select Committee Members</label>
						<div class="form-check mb-2">
							<input class="form-check-input" type="checkbox" id="sendToAllCommittee">
							<label class="form-check-label" for="sendToAllCommittee">
								<strong>Send to All Active Committee Members</strong>
							</label>
						</div>
					</div>

					<div id="committeeSelectContainer">
						<label class="form-label">Or select specific members:</label>
						<div id="committeeCheckboxes">
							<!-- Committee member checkboxes will be loaded here -->
						</div>
					</div>

					<div class="mt-3">
						<small class="text-muted">
							<i class="fas fa-envelope me-1"></i>
							Selected committee members will receive an email with the speaker's complete details for review.
						</small>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-success" onclick="sendSpeakerToCommittee()">
						<i class="fas fa-paper-plane me-2"></i>Send for Review
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Update Speaker Review Status Modal -->
	<div class="modal fade" id="updateSpeakerStatusModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="fas fa-clipboard-check me-2"></i>Update Speaker Review Status</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="updateSpeakerStatusForm">
						<input type="hidden" id="updateStatusSpeakerId">
						<div class="mb-3">
							<label for="speakerReviewStatus" class="form-label">Review Status</label>
							<select class="form-control" id="speakerReviewStatus" required>
								<option value="">Choose Status</option>
								<option value="PENDING">Pending</option>
								<option value="SENT_TO_COMMITTEE">Sent to Committee</option>
								<option value="UNDER_REVIEW">Under Review</option>
								<option value="APPROVED">Approved</option>
								<option value="REJECTED">Rejected</option>
								<option value="NEEDS_REVISION">Needs Revision</option>
							</select>
						</div>
						<div class="mb-3">
							<label for="speakerStatusNotes" class="form-label">Notes (Optional)</label>
							<textarea class="form-control" id="speakerStatusNotes" rows="3" placeholder="Add any notes about this status change..."></textarea>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary-custom" onclick="updateSpeakerReviewStatus()">
						<i class="fas fa-save me-2"></i>Update Status
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- JavaScript Libraries -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
	<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

	<script>
		const API_BASE = 'https://egsconferencebackend-production.up.railway.app/api';
		let currentData = {};

		// Check authentication on page load
		document.addEventListener('DOMContentLoaded', function () {
			const token = localStorage.getItem('adminToken');
			if (!token) {
				window.location.href = 'index.html';
				return;
			}
			loadDashboardData();
		});

		// Utility Functions
		function showLoading() {
			document.getElementById('loadingOverlay').classList.remove('d-none');
		}

		function hideLoading() {
			document.getElementById('loadingOverlay').classList.add('d-none');
		}

		function showAlert(message, type = 'success') {
			const alertDiv = document.createElement('div');
			alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
			alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 10000; min-width: 300px;';
			alertDiv.innerHTML = `
				${message}
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			`;
			document.body.appendChild(alertDiv);
			setTimeout(() => alertDiv.remove(), 5000);
		}

		function getAuthHeaders() {
			return {
				'Authorization': `Bearer ${localStorage.getItem('adminToken')}`,
				'Content-Type': 'application/json'
			};
		}

		// Navigation Functions
		function toggleSidebar() {
			const sidebar = document.getElementById('sidebar');
			const mainContent = document.getElementById('mainContent');
			sidebar.classList.toggle('collapsed');
			mainContent.classList.toggle('expanded');
		}

		function showSection(sectionName) {
			// Hide all sections
			document.querySelectorAll('.content-section').forEach(section => {
				section.classList.add('d-none');
			});
			
			// Remove active class from all nav links
			document.querySelectorAll('.nav-link').forEach(link => {
				link.classList.remove('active');
			});
			
			// Map section names to their corresponding element IDs
			const sectionMap = {
				'dashboard': 'dashboardSection',
				'admins': 'adminsSection',
				'registrations': 'registrationsSection',
				'speakers': 'speakersSection',
				'keynote-speakers': 'keynoteSpeakersSection',
				'sponsors': 'sponsorsSection',
				'reviewing-committee': 'reviewingCommitteeSection',
				'analytics': 'analyticsSection'
			};
			
			// Show selected section
			const sectionId = sectionMap[sectionName] || sectionName + 'Section';
			document.getElementById(sectionId).classList.remove('d-none');
			
			// Add active class to clicked nav link
			event.target.classList.add('active');
			
			// Load section-specific data
			switch(sectionName) {
				case 'dashboard':
					loadDashboardData();
					break;
				case 'admins':
					loadAdmins();
					break;
				case 'registrations':
					loadRegistrations();
					break;
				case 'speakers':
					loadSpeakers();
					break;
				case 'keynote-speakers':
					loadKeynoteSpeakers();
					break;
				case 'sponsors':
					loadSponsors();
					break;
				case 'reviewing-committee':
					loadCommitteeMembers();
					break;
				case 'analytics':
					loadAnalytics();
					break;
			}
		}

		// Dashboard Functions
		async function loadDashboardData() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/dashboard-stats`, {
					headers: getAuthHeaders()
				});
				
				if (!response.ok) {
					throw new Error(`HTTP ${response.status}: ${response.statusText}`);
				}
				
				const stats = await response.json();
				console.log('Super Admin Dashboard stats received:', stats); // Debug log
				displayDashboardStats(stats);
				loadRecentActivity();
			} catch (error) {
				console.error('Error loading dashboard:', error);
				showAlert(`Error loading dashboard data: ${error.message}`, 'danger');
			} finally {
				hideLoading();
			}
		}

		function displayDashboardStats(stats) {
			const statsContainer = document.getElementById('statsContainer');
			const statsCards = [
				{ title: 'Total Registrations', value: stats.registrations || 0, icon: 'fas fa-users', color: 'bg-primary' },
				{ title: 'Total Speakers', value: stats.speakers || 0, icon: 'fas fa-microphone', color: 'bg-success' },
				{ title: 'Keynote Speakers', value: stats.keynoteSpeakers || 0, icon: 'fas fa-star', color: 'bg-purple' },
				{ title: 'Total Sponsors', value: stats.sponsors || 0, icon: 'fas fa-handshake', color: 'bg-warning' },
				{ title: 'Total Admins', value: stats.admins || 0, icon: 'fas fa-user-shield', color: 'bg-info' }
			];

			statsContainer.innerHTML = '';
			statsCards.forEach(card => {
				const cardHtml = `
					<div class="col-lg-2 col-md-4 col-sm-6 mb-4">
						<div class="stats-card">
							<div class="d-flex align-items-center">
								<div class="stats-icon ${card.color}">
									<i class="${card.icon}"></i>
								</div>
								<div class="ms-3">
									<h3 class="mb-0">${card.value}</h3>
									<p class="text-muted mb-0">${card.title}</p>
								</div>
							</div>
						</div>
					</div>
				`;
				statsContainer.innerHTML += cardHtml;
			});
		}

		async function loadRecentActivity() {
			// Mock recent activity data
			const recentActivity = document.getElementById('recentActivity');
			recentActivity.innerHTML = `
				<tr>
					<td><span class="badge bg-success">Registration</span></td>
					<td>Conference</td>
					<td>New attendee registered</td>
					<td>2 hours ago</td>
				</tr>
				<tr>
					<td><span class="badge bg-info">Speaker</span></td>
					<td>Call for Papers</td>
					<td>New paper submission</td>
					<td>4 hours ago</td>
				</tr>
				<tr>
					<td><span class="badge bg-warning">Sponsor</span></td>
					<td>Sponsorship</td>
					<td>New sponsor inquiry</td>
					<td>6 hours ago</td>
				</tr>
			`;
		}

		// Admin Management Functions
		async function loadAdmins() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/all`, {
					headers: getAuthHeaders()
				});
				const admins = await response.json();
				displayAdmins(admins);
			} catch (error) {
				console.error('Error loading admins:', error);
				showAlert('Error loading admins', 'danger');
			} finally {
				hideLoading();
			}
		}

		function displayAdmins(admins) {
			const container = document.getElementById('adminsContainer');
			container.innerHTML = '';

			admins.forEach(admin => {
				const adminCard = `
					<div class="col-md-6 col-lg-4 mb-4">
						<div class="admin-card">
							<div class="d-flex justify-content-between align-items-start mb-3">
								<h5 class="text-primary">${admin.email}</h5>
								<div class="dropdown">
									<button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
										<i class="fas fa-ellipsis-v"></i>
									</button>
									<ul class="dropdown-menu">
										<li><a class="dropdown-item" href="#" onclick="deleteAdmin(${admin.id})">
											<i class="fas fa-trash text-danger me-2"></i>Delete
										</a></li>
									</ul>
								</div>
							</div>
							<div class="referral-code">
								${admin.referralCode}
								<button class="copy-btn" onclick="copyToClipboard('${admin.referralCode}')">
									<i class="fas fa-copy"></i>
								</button>
							</div>
							<div class="mt-3">
								<small class="text-muted">Referral Links:</small>
								<div class="d-grid gap-2 mt-2">
									<button class="btn btn-sm btn-outline-primary" onclick="copyToClipboard('${window.location.origin}/../register.html?ref=${admin.referralCode}')">
										<i class="fas fa-link me-1"></i>Conference Registration
									</button>
									<button class="btn btn-sm btn-outline-success" onclick="copyToClipboard('${window.location.origin}/../paper.html?ref=${admin.referralCode}')">
										<i class="fas fa-link me-1"></i>Speaker Registration
									</button>
								</div>
							</div>
							<div class="mt-3">
								<small class="text-muted">Referred Users: </small>
								<span class="badge bg-primary">${admin.referredUsers?.length || 0}</span>
							</div>
							${admin.referredUsers?.length > 0 ? `
								<div class="mt-2">
									<small class="text-muted">Recent Referrals:</small>
									<ul class="list-unstyled mt-1" style="max-height: 100px; overflow-y: auto;">
										${admin.referredUsers.slice(-3).map(user => `
											<li class="small">${user.name} (${user.email})</li>
										`).join('')}
									</ul>
								</div>
							` : ''}
						</div>
					</div>
				`;
				container.innerHTML += adminCard;
			});
		}

		async function createAdmin() {
			const email = document.getElementById('adminEmail').value;
			const password = document.getElementById('adminPassword').value;

			if (!email || !password) {
				showAlert('Please fill in all fields', 'warning');
				return;
			}

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/create`, {
					method: 'POST',
					headers: getAuthHeaders(),
					body: JSON.stringify({ email, password })
				});

				const result = await response.json();
				if (response.ok) {
					showAlert(`Admin created successfully! Referral Code: ${result.referralCode}`, 'success');
					document.getElementById('createAdminForm').reset();
					bootstrap.Modal.getInstance(document.getElementById('createAdminModal')).hide();
					loadAdmins();
				} else {
					throw new Error(result.message || 'Error creating admin');
				}
			} catch (error) {
				console.error('Error creating admin:', error);
				showAlert(error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteAdmin(adminId) {
			if (!confirm('Are you sure you want to delete this admin? This action cannot be undone.')) {
				return;
			}

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/admins/${adminId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				if (response.ok) {
					showAlert('Admin deleted successfully', 'success');
					loadAdmins();
				} else {
					throw new Error('Error deleting admin');
				}
			} catch (error) {
				console.error('Error deleting admin:', error);
				showAlert('Error deleting admin', 'danger');
			} finally {
				hideLoading();
			}
		}

		// Registration Management Functions
		async function loadRegistrations() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/registrations`, {
					headers: getAuthHeaders()
				});
				const registrations = await response.json();
				currentData.registrations = registrations;
				displayRegistrations(registrations);
			} catch (error) {
				console.error('Error loading registrations:', error);
				showAlert('Error loading registrations', 'danger');
			} finally {
				hideLoading();
			}
		}

		function displayRegistrations(registrations) {
			document.getElementById('registrationsCount').textContent = registrations.length;
			
			if ($.fn.DataTable.isDataTable('#registrationsTable')) {
				$('#registrationsTable').DataTable().destroy();
			}

			$('#registrationsTable').DataTable({
				data: registrations,
				columns: [
					{ 
						data: 'id',
						title: 'ID',
						responsivePriority: 9,
						className: 'd-none d-xl-table-cell',
						width: '60px'
					},
					{ 
						data: 'name',
						title: 'Name',
						responsivePriority: 1,
						render: function(data, type, row) {
							return `<div>
								<div class="fw-bold">${data}</div>
								<small class="text-muted d-md-none">${row.email}</small>
							</div>`;
						}
					},
					{ 
						data: 'email',
						title: 'Email',
						responsivePriority: 3,
						className: 'd-none d-md-table-cell',
						render: function(data) {
							return `<a href="mailto:${data}" class="text-decoration-none">${data}</a>`;
						}
					},
					{ 
						data: 'registrationType',
						title: 'Type',
						responsivePriority: 4,
						className: 'd-none d-lg-table-cell'
					},
					{ 
						data: 'regFee',
						title: 'Fee',
						responsivePriority: 5,
						className: 'd-none d-lg-table-cell',
						render: function(data) {
							return data ? `$${data}` : '-';
						}
					},
					{ 
						data: 'isPaid',
						title: 'Status',
						responsivePriority: 2,
						render: function(data) {
							return data ? '<span class="badge bg-success">Paid</span>' : '<span class="badge bg-warning">Pending</span>';
						}
					},
					{ 
						data: 'referredBy',
						title: 'Referred By',
						responsivePriority: 7,
						className: 'd-none d-xl-table-cell',
						render: function(data) {
							return data ? data.email : '-';
						}
					},
					{ 
						data: 'createdAt',
						title: 'Date',
						responsivePriority: 6,
						className: 'd-none d-lg-table-cell',
						render: function(data) {
							return new Date(data).toLocaleDateString();
						}
					},
					{
						data: null,
						title: 'Actions',
						responsivePriority: 1,
						className: 'text-center',
						orderable: false,
						render: function(data, type, row) {
							return `
								<div class="btn-group">
									<button class="btn btn-sm btn-outline-primary" onclick="editRegistration(${row.id})" title="Edit">
										<i class="fas fa-edit"></i>
									</button>
									<button class="btn btn-sm btn-outline-danger" onclick="deleteRegistration(${row.id})" title="Delete">
										<i class="fas fa-trash"></i>
									</button>
								</div>
							`;
						}
					}
				],
				responsive: {
					details: {
						type: 'column',
						target: 'tr'
					}
				},
				pageLength: 25,
				order: [[7, 'desc']], // Sort by date (newest first)
				scrollX: true,
				autoWidth: false,
				columnDefs: [
					{ width: "60px", targets: 0 },
					{ width: "150px", targets: 1 },
					{ width: "180px", targets: 2 },
					{ width: "120px", targets: 3 },
					{ width: "100px", targets: 4 },
					{ width: "100px", targets: 5 },
					{ width: "150px", targets: 6 },
					{ width: "120px", targets: 7 },
					{ width: "120px", targets: 8 }
				],
				dom: 'Bfrtip',
				buttons: [
					{
						extend: 'csv',
						text: '<i class="fas fa-download"></i> CSV',
						className: 'btn btn-success btn-sm'
					}
				],
				language: {
					emptyTable: "No registrations found",
					info: "Showing _START_ to _END_ of _TOTAL_ registrations",
					infoEmpty: "Showing 0 to 0 of 0 registrations",
					infoFiltered: "(filtered from _MAX_ total registrations)"
				}
			});
		}

		function editRegistration(registrationId) {
			const registration = currentData.registrations.find(r => r.id === registrationId);
			if (!registration) return;

			document.getElementById('editRegId').value = registration.id;
			document.getElementById('editRegName').value = registration.name;
			document.getElementById('editRegEmail').value = registration.email;
			document.getElementById('editRegPhone').value = registration.phone || '';
			document.getElementById('editRegType').value = registration.registrationType;
			document.getElementById('editRegInstitution').value = registration.institutionName || '';
			document.getElementById('editRegCountry').value = registration.country || '';
			document.getElementById('editRegFee').value = registration.regFee;
			document.getElementById('editRegStatus').value = registration.isPaid.toString();

			new bootstrap.Modal(document.getElementById('editRegistrationModal')).show();
		}

		async function updateRegistration() {
			const formData = {
				name: document.getElementById('editRegName').value,
				email: document.getElementById('editRegEmail').value,
				phone: document.getElementById('editRegPhone').value,
				registrationType: document.getElementById('editRegType').value,
				institutionName: document.getElementById('editRegInstitution').value,
				country: document.getElementById('editRegCountry').value,
				regFee: document.getElementById('editRegFee').value,
				isPaid: document.getElementById('editRegStatus').value === 'true'
			};

			try {
				showLoading();
				const id = document.getElementById('editRegId').value;
				const response = await fetch(`${API_BASE}/admin/registrations/${id}`, {
					method: 'PUT',
					headers: getAuthHeaders(),
					body: JSON.stringify(formData)
				});

				if (response.ok) {
					showAlert('Registration updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('editRegistrationModal')).hide();
					loadRegistrations();
				} else {
					throw new Error('Error updating registration');
				}
			} catch (error) {
				console.error('Error updating registration:', error);
				showAlert('Error updating registration', 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteRegistration(registrationId) {
			if (!confirm('Are you sure you want to delete this registration?')) return;

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/registrations/${registrationId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				if (response.ok) {
					showAlert('Registration deleted successfully', 'success');
					loadRegistrations();
				} else {
					throw new Error('Error deleting registration');
				}
			} catch (error) {
				console.error('Error deleting registration:', error);
				showAlert('Error deleting registration', 'danger');
			} finally {
				hideLoading();
			}
		}

		// Speaker Management Functions
		let committeeMembers = [];

		// Helper function to get review status badge
		function getReviewStatusBadge(status) {
			const statusClasses = {
				'PENDING': 'bg-warning',
				'SENT_TO_COMMITTEE': 'bg-info',
				'UNDER_REVIEW': 'bg-primary',
				'APPROVED': 'bg-success',
				'REJECTED': 'bg-danger',
				'NEEDS_REVISION': 'bg-warning'
			};
			const statusText = {
				'PENDING': 'Pending',
				'SENT_TO_COMMITTEE': 'Sent to Committee',
				'UNDER_REVIEW': 'Under Review',
				'APPROVED': 'Approved',
				'REJECTED': 'Rejected',
				'NEEDS_REVISION': 'Needs Revision'
			};
			return `<span class="badge ${statusClasses[status] || 'bg-secondary'}">${statusText[status] || status}</span>`;
		}

		// Load active committee members for dropdown
		async function loadActiveCommitteeMembers() {
			try {
				console.log('Loading active committee members...');
				const response = await fetch(`${API_BASE}/reviewing-committee/active-members`, {
					headers: getAuthHeaders()
				});
				
				console.log('Active committee response status:', response.status);
				
				if (response.ok) {
					const result = await response.json();
					console.log('Active committee members response:', result);
					committeeMembers = result.data || [];
					console.log('Stored committee members:', committeeMembers);
				} else {
					const errorText = await response.text();
					console.error('Active committee API Error:', response.status, errorText);
				}
			} catch (error) {
				console.error('Error loading active committee members:', error);
			}
		}

		async function loadSpeakers() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/speakers`, {
					headers: getAuthHeaders()
				});
				const speakers = await response.json();
				currentData.speakers = speakers;
				
				// Load committee members for the send to committee functionality
				await loadActiveCommitteeMembers();
				
				displaySpeakers(speakers);
			} catch (error) {
				console.error('Error loading speakers:', error);
				showAlert('Error loading speakers', 'danger');
			} finally {
				hideLoading();
			}
		}

		function displaySpeakers(speakers) {
			document.getElementById('speakersCount').textContent = speakers.length;
			
			if ($.fn.DataTable.isDataTable('#speakersTable')) {
				$('#speakersTable').DataTable().destroy();
			}

			$('#speakersTable').DataTable({
				data: speakers,
				columns: [
					{ 
						data: 'fileUrl',
						title: 'Paper',
						className: 'text-center',
						responsivePriority: 5,
						render: function(data, type, row) {
							if (data) {
								return `<a href="${data}" target="_blank" class="btn btn-sm btn-outline-info" title="View Paper">
									<i class="fas fa-file-pdf"></i>
								</a>`;
							}
							return '<span class="text-muted">-</span>';
						}
					},
					{ 
						data: 'name',
						title: 'Name',
						responsivePriority: 1,
						render: function(data, type, row) {
							return `<div class="d-flex align-items-center">
								<div>
									<div class="fw-bold">${data}</div>
									<small class="text-muted d-md-none">${row.email}</small>
								</div>
							</div>`;
						}
					},
					{ 
						data: 'email',
						title: 'Email',
						responsivePriority: 4,
						className: 'd-none d-md-table-cell',
						render: function(data) {
							return `<a href="mailto:${data}" class="text-decoration-none">${data}</a>`;
						}
					},
					{ 
						data: 'institutionName',
						title: 'Institution',
						responsivePriority: 6,
						className: 'd-none d-lg-table-cell',
						render: function(data) {
							return data || '-';
						}
					},
					{ 
						data: 'paperTitle',
						title: 'Paper Title',
						responsivePriority: 3,
						render: function(data, type, row) {
							if (data && data.length > 50) {
								return `<span title="${data}">${data.substring(0, 50)}...</span>`;
							}
							return data || '-';
						}
					},
					{ 
						data: 'country',
						title: 'Country',
						responsivePriority: 7,
						className: 'd-none d-xl-table-cell',
						render: function(data) {
							return data || '-';
						}
					},
					{ 
						data: 'reviewStatus',
						title: 'Review Status',
						responsivePriority: 2,
						render: function(data, type, row) {
							return getReviewStatusBadge(data);
						}
					},
					{ 
						data: 'createdAt',
						title: 'Date',
						responsivePriority: 8,
						className: 'd-none d-lg-table-cell',
						render: function(data) {
							return new Date(data).toLocaleDateString();
						}
					},
					{
						data: null,
						title: 'Actions',
						responsivePriority: 1,
						className: 'text-center',
						orderable: false,
						render: function(data, type, row) {
							const canSendToCommittee = !row.sentToCommittee && row.reviewStatus === 'PENDING';
							
							return `
								<div class="btn-group">
									${canSendToCommittee ? 
										`<button class="btn btn-sm btn-success me-1" onclick="showSendToCommitteeModal('${row.id}')" title="Send to Committee">
											<i class="fas fa-users-cog"></i>
										</button>` : 
										`<button class="btn btn-sm btn-info me-1" onclick="showUpdateSpeakerStatusModal('${row.id}')" title="Update Status">
											<i class="fas fa-clipboard-check"></i>
										</button>`
									}
									<button class="btn btn-sm btn-outline-primary" onclick="editSpeaker(${row.id})" title="Edit">
										<i class="fas fa-edit"></i>
									</button>
									<button class="btn btn-sm btn-outline-danger" onclick="deleteSpeaker(${row.id})" title="Delete">
										<i class="fas fa-trash"></i>
									</button>
								</div>
							`;
						}
					}
				],
				responsive: {
					details: {
						type: 'column',
						target: 'tr'
					}
				},
				pageLength: 25,
				order: [[7, 'desc']], // Sort by date (newest first)
				scrollX: true,
				autoWidth: false,
				columnDefs: [
					{ width: "80px", targets: 0 },
					{ width: "150px", targets: 1 },
					{ width: "180px", targets: 2 },
					{ width: "180px", targets: 3 },
					{ width: "250px", targets: 4 },
					{ width: "120px", targets: 5 },
					{ width: "150px", targets: 6 },
					{ width: "120px", targets: 7 },
					{ width: "120px", targets: 8 }
				],
				dom: 'Bfrtip',
				buttons: [
					{
						extend: 'csv',
						text: '<i class="fas fa-download"></i> CSV',
						className: 'btn btn-success btn-sm'
					}
				],
				language: {
					emptyTable: "No presenters found",
					info: "Showing _START_ to _END_ of _TOTAL_ presenters",
					infoEmpty: "Showing 0 to 0 of 0 presenters",
					infoFiltered: "(filtered from _MAX_ total presenters)"
				}
			});
		}

		// Show send to committee modal
		async function showSendToCommitteeModal(speakerId) {
			const speaker = currentData.speakers.find(s => s.id === speakerId);
			if (!speaker) return;

			document.getElementById('sendToCommitteeSpeakerId').value = speakerId;
			document.getElementById('speakerNameDisplay').textContent = speaker.name;
			document.getElementById('paperTitleDisplay').textContent = speaker.paperTitle;

			// Populate committee checkboxes
			const checkboxContainer = document.getElementById('committeeCheckboxes');
			checkboxContainer.innerHTML = '';

			if (committeeMembers.length === 0) {
				checkboxContainer.innerHTML = '<p class="text-muted">No active committee members found. Please add committee members first.</p>';
			} else {
				committeeMembers.forEach(member => {
					checkboxContainer.innerHTML += `
						<div class="form-check mb-2">
							<input class="form-check-input committee-member-check" type="checkbox" value="${member.id}" id="member_${member.id}">
							<label class="form-check-label" for="member_${member.id}">
								<strong>${member.name}</strong> - ${member.designation}<br>
								<small class="text-muted">${member.institution} | ${member.expertise}</small>
							</label>
						</div>
					`;
				});
			}

			// Handle "send to all" checkbox
			document.getElementById('sendToAllCommittee').addEventListener('change', function() {
				const memberChecks = document.querySelectorAll('.committee-member-check');
				const container = document.getElementById('committeeSelectContainer');
				
				if (this.checked) {
					container.style.display = 'none';
				} else {
					container.style.display = 'block';
				}
			});

			new bootstrap.Modal(document.getElementById('sendToCommitteeModal')).show();
		}

		// Send speaker to committee
		async function sendSpeakerToCommittee() {
			const speakerId = document.getElementById('sendToCommitteeSpeakerId').value;
			const sendToAll = document.getElementById('sendToAllCommittee').checked;
			
			let committeeIds = [];
			if (!sendToAll) {
				const checkedBoxes = document.querySelectorAll('.committee-member-check:checked');
				committeeIds = Array.from(checkedBoxes).map(cb => cb.value);
				
				if (committeeIds.length === 0) {
					showAlert('Please select at least one committee member or choose "Send to All"', 'warning');
					return;
				}
			}

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/reviewing-committee/send-speaker/${speakerId}`, {
					method: 'POST',
					headers: getAuthHeaders(),
					body: JSON.stringify({
						committeeIds: sendToAll ? [] : committeeIds,
						sendToAll: sendToAll
					})
				});

				const result = await response.json();
				if (response.ok) {
					showAlert(result.message, 'success');
					bootstrap.Modal.getInstance(document.getElementById('sendToCommitteeModal')).hide();
					loadSpeakers(); // Reload speakers to update status
				} else {
					throw new Error(result.message || 'Failed to send speaker to committee');
				}
			} catch (error) {
				console.error('Error sending speaker to committee:', error);
				showAlert('Error: ' + error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		// Show update speaker status modal
		function showUpdateSpeakerStatusModal(speakerId) {
			const speaker = currentData.speakers.find(s => s.id === speakerId);
			if (!speaker) return;

			document.getElementById('updateStatusSpeakerId').value = speakerId;
			document.getElementById('speakerReviewStatus').value = speaker.reviewStatus;

			new bootstrap.Modal(document.getElementById('updateSpeakerStatusModal')).show();
		}

		// Update speaker review status
		async function updateSpeakerReviewStatus() {
			const speakerId = document.getElementById('updateStatusSpeakerId').value;
			const reviewStatus = document.getElementById('speakerReviewStatus').value;
			const notes = document.getElementById('speakerStatusNotes').value;

			if (!reviewStatus) {
				showAlert('Please select a review status', 'warning');
				return;
			}

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/reviewing-committee/speaker-status/${speakerId}`, {
					method: 'PUT',
					headers: getAuthHeaders(),
					body: JSON.stringify({
						reviewStatus: reviewStatus,
						notes: notes
					})
				});

				const result = await response.json();
				if (response.ok) {
					showAlert('Speaker status updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('updateSpeakerStatusModal')).hide();
					loadSpeakers(); // Reload speakers to update status
				} else {
					throw new Error(result.message || 'Failed to update speaker status');
				}
			} catch (error) {
				console.error('Error updating speaker status:', error);
				showAlert('Error: ' + error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		function editSpeaker(speakerId) {
			const speaker = currentData.speakers.find(s => s.id === speakerId);
			if (!speaker) return;

			document.getElementById('editSpeakerId').value = speaker.id;
			document.getElementById('editSpeakerName').value = speaker.name;
			document.getElementById('editSpeakerEmail').value = speaker.email;
			document.getElementById('editSpeakerInstitution').value = speaker.institutionName || '';
			document.getElementById('editSpeakerCountry').value = speaker.country || '';
			document.getElementById('editSpeakerPaperTitle').value = speaker.paperTitle || '';
			document.getElementById('editSpeakerPhone').value = speaker.phone || '';
			
			// Display current file
			const currentFileDisplay = document.getElementById('currentFileDisplay');
			if (speaker.fileUrl) {
				currentFileDisplay.innerHTML = `<a href="${speaker.fileUrl}" target="_blank" class="btn btn-sm btn-outline-primary"><i class="fas fa-file-pdf"></i> View Current File</a>`;
			} else {
				currentFileDisplay.innerHTML = '<span class="text-muted">No file uploaded</span>';
			}

			new bootstrap.Modal(document.getElementById('editSpeakerModal')).show();
		}

		async function updateSpeaker() {
			const form = document.getElementById('editSpeakerForm');
			const formData = new FormData();
			
			// Add form fields to FormData
			formData.append('name', document.getElementById('editSpeakerName').value);
			formData.append('email', document.getElementById('editSpeakerEmail').value);
			formData.append('institutionName', document.getElementById('editSpeakerInstitution').value);
			formData.append('country', document.getElementById('editSpeakerCountry').value);
			formData.append('paperTitle', document.getElementById('editSpeakerPaperTitle').value);
			formData.append('phone', document.getElementById('editSpeakerPhone').value);
			
			// Add file if selected
			const fileInput = document.getElementById('editSpeakerFile');
			if (fileInput.files.length > 0) {
				formData.append('fileInput', fileInput.files[0]);
			}

			try {
				showLoading();
				const id = document.getElementById('editSpeakerId').value;
				const response = await fetch(`${API_BASE}/admin/speakers/${id}`, {
					method: 'PUT',
					headers: {
						'Authorization': `Bearer ${localStorage.getItem('adminToken')}`
					},
					body: formData
				});

				if (response.ok) {
					showAlert('Speaker updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('editSpeakerModal')).hide();
					loadSpeakers();
				} else {
					throw new Error('Error updating speaker');
				}
			} catch (error) {
				console.error('Error updating speaker:', error);
				showAlert('Error updating speaker', 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteSpeaker(speakerId) {
			if (!confirm('Are you sure you want to delete this speaker?')) return;

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/speakers/${speakerId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				if (response.ok) {
					showAlert('Speaker deleted successfully', 'success');
					loadSpeakers();
				} else {
					throw new Error('Error deleting speaker');
				}
			} catch (error) {
				console.error('Error deleting speaker:', error);
				showAlert('Error deleting speaker', 'danger');
			} finally {
				hideLoading();
			}
		}

		// Keynote Speaker Management Functions
		async function loadKeynoteSpeakers() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/keynote-speakers`, {
					headers: getAuthHeaders()
				});
				const keynoteSpeakers = await response.json();
				currentData.keynoteSpeakers = keynoteSpeakers;
				displayKeynoteSpeakers(keynoteSpeakers);
			} catch (error) {
				console.error('Error loading keynote speakers:', error);
				showAlert('Error loading keynote speakers', 'danger');
			} finally {
				hideLoading();
			}
		}

		function displayKeynoteSpeakers(keynoteSpeakers) {
			document.getElementById('keynoteSpeakersCount').textContent = keynoteSpeakers.length;
			
			if ($.fn.DataTable.isDataTable('#keynoteSpeakersTable')) {
				$('#keynoteSpeakersTable').DataTable().destroy();
			}

			$('#keynoteSpeakersTable').DataTable({
				data: keynoteSpeakers,
				columns: [
					{ data: 'name', title: 'Name' },
					{ data: 'email', title: 'Email' },
					{ data: 'institutionName', title: 'Institution' },
					{ data: 'keynoteTitle', title: 'Keynote Title' },
					{ 
						data: 'status',
						title: 'Status',
						render: function(data) {
							const statusColors = {
								'PENDING': 'warning',
								'UNDER_REVIEW': 'info',
								'APPROVED': 'success',
								'REJECTED': 'danger',
								'CONFIRMED': 'primary'
							};
							const color = statusColors[data] || 'secondary';
							return `<span class="badge bg-${color}">${data}</span>`;
						}
					},
					{ 
						data: 'createdAt',
						title: 'Registered',
						render: function(data) {
							return data ? new Date(data).toLocaleDateString() : 'N/A';
						}
					},
					{
						data: null,
						title: 'Actions',
						render: function(data, type, row) {
							return `
								<div class="btn-group">
									<button class="btn btn-sm btn-outline-primary" onclick="editKeynoteSpeaker('${row.id}')" title="Edit">
										<i class="fas fa-edit"></i>
									</button>
									<button class="btn btn-sm btn-outline-danger" onclick="deleteKeynoteSpeaker('${row.id}')" title="Delete">
										<i class="fas fa-trash"></i>
									</button>
								</div>
							`;
						}
					}
				],
				responsive: true,
				pageLength: 25,
				order: [[5, 'desc']], // Sort by registration date descending
				dom: 'Bfrtip',
				buttons: [
					{
						extend: 'csv',
						text: '<i class="fas fa-download"></i> CSV',
						className: 'btn btn-success btn-sm'
					}
				]
			});
		}

		function editKeynoteSpeaker(keynoteSpeakerId) {
			const keynoteSpeaker = currentData.keynoteSpeakers.find(ks => ks.id === keynoteSpeakerId);
			if (!keynoteSpeaker) return;

			// Populate form fields with keynote speaker data
			document.getElementById('editKeynoteSpeakerId').value = keynoteSpeaker.id;
			document.getElementById('editKeynoteSpeakerName').value = keynoteSpeaker.name || '';
			document.getElementById('editKeynoteSpeakerEmail').value = keynoteSpeaker.email || '';
			document.getElementById('editKeynoteSpeakerPhone').value = keynoteSpeaker.phone || '';
			document.getElementById('editKeynoteSpeakerCountry').value = keynoteSpeaker.country || '';
			document.getElementById('editKeynoteSpeakerDesignation').value = keynoteSpeaker.designation || '';
			document.getElementById('editKeynoteSpeakerInstitution').value = keynoteSpeaker.institutionName || '';
			document.getElementById('editKeynoteSpeakerExperience').value = keynoteSpeaker.experienceYears || '';
			document.getElementById('editKeynoteSpeakerSpecialization').value = keynoteSpeaker.specialization || '';
			document.getElementById('editKeynoteSpeakerTitle').value = keynoteSpeaker.keynoteTitle || '';
			document.getElementById('editKeynoteSpeakerAbstract').value = keynoteSpeaker.keynoteAbstract || '';
			document.getElementById('editKeynoteSpeakerStatus').value = keynoteSpeaker.status || 'PENDING';

			new bootstrap.Modal(document.getElementById('editKeynoteSpeakerModal')).show();
		}

		async function updateKeynoteSpeaker() {
			const formData = {
				name: document.getElementById('editKeynoteSpeakerName').value,
				email: document.getElementById('editKeynoteSpeakerEmail').value,
				phone: document.getElementById('editKeynoteSpeakerPhone').value,
				country: document.getElementById('editKeynoteSpeakerCountry').value,
				designation: document.getElementById('editKeynoteSpeakerDesignation').value,
				institutionName: document.getElementById('editKeynoteSpeakerInstitution').value,
				experienceYears: document.getElementById('editKeynoteSpeakerExperience').value,
				specialization: document.getElementById('editKeynoteSpeakerSpecialization').value,
				keynoteTitle: document.getElementById('editKeynoteSpeakerTitle').value,
				keynoteAbstract: document.getElementById('editKeynoteSpeakerAbstract').value,
				status: document.getElementById('editKeynoteSpeakerStatus').value
			};

			try {
				showLoading();
				const id = document.getElementById('editKeynoteSpeakerId').value;
				const response = await fetch(`${API_BASE}/admin/keynote-speakers/${id}`, {
					method: 'PUT',
					headers: getAuthHeaders(),
					body: JSON.stringify(formData)
				});

				if (response.ok) {
					showAlert('Keynote Speaker updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('editKeynoteSpeakerModal')).hide();
					loadKeynoteSpeakers();
				} else {
					const errorData = await response.json();
					throw new Error(errorData.message || 'Error updating keynote speaker');
				}
			} catch (error) {
				console.error('Error updating keynote speaker:', error);
				showAlert(`Error updating keynote speaker: ${error.message}`, 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteKeynoteSpeaker(keynoteSpeakerId) {
			if (!confirm('Are you sure you want to delete this keynote speaker? This action cannot be undone.')) return;

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/keynote-speakers/${keynoteSpeakerId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				if (response.ok) {
					showAlert('Keynote Speaker deleted successfully', 'success');
					loadKeynoteSpeakers();
				} else {
					const errorData = await response.json();
					throw new Error(errorData.message || 'Error deleting keynote speaker');
				}
			} catch (error) {
				console.error('Error deleting keynote speaker:', error);
				showAlert(`Error deleting keynote speaker: ${error.message}`, 'danger');
			} finally {
				hideLoading();
			}
		}

		// Sponsor Management Functions
		async function loadSponsors() {
			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/sponsors`, {
					headers: getAuthHeaders()
				});
				const sponsors = await response.json();
				currentData.sponsors = sponsors;
				displaySponsors(sponsors);
			} catch (error) {
				console.error('Error loading sponsors:', error);
				showAlert('Error loading sponsors', 'danger');
			} finally {
				hideLoading();
			}
		}

		function displaySponsors(sponsors) {
			document.getElementById('sponsorsCount').textContent = sponsors.length;
			
			if ($.fn.DataTable.isDataTable('#sponsorsTable')) {
				$('#sponsorsTable').DataTable().destroy();
			}

			$('#sponsorsTable').DataTable({
				data: sponsors,
				columns: [
					{ data: 'id' },
					{ data: 'organizationName' },
					{ data: 'contactName' },
					{ data: 'email' },
					{ data: 'phone' },
					{ data: 'sponsorshipPackage' },
					{ 
						data: 'createdAt',
						render: function(data) {
							return new Date(data).toLocaleDateString();
						}
					},
					{
						data: null,
						render: function(data, type, row) {
							return `
								<div class="btn-group">
									<button class="btn btn-sm btn-outline-primary" onclick="editSponsor(${row.id})">
										<i class="fas fa-edit"></i>
									</button>
									<button class="btn btn-sm btn-outline-danger" onclick="deleteSponsor(${row.id})">
										<i class="fas fa-trash"></i>
									</button>
								</div>
							`;
						}
					}
				],
				responsive: true,
				pageLength: 25,
				dom: 'Bfrtip',
				buttons: [
					{
						extend: 'csv',
						text: '<i class="fas fa-download"></i> CSV',
						className: 'btn btn-success btn-sm'
					}
				]
			});
		}

		function editSponsor(sponsorId) {
			const sponsor = currentData.sponsors.find(s => s.id === sponsorId);
			if (!sponsor) return;

			document.getElementById('editSponsorId').value = sponsor.id;
			document.getElementById('editSponsorOrganization').value = sponsor.organizationName;
			document.getElementById('editSponsorContactName').value = sponsor.contactName;
			document.getElementById('editSponsorEmail').value = sponsor.email;
			document.getElementById('editSponsorPhone').value = sponsor.phone || '';
			document.getElementById('editSponsorPackage').value = sponsor.sponsorshipPackage || '';

			new bootstrap.Modal(document.getElementById('editSponsorModal')).show();
		}

		async function updateSponsor() {
			const formData = {
				organizationName: document.getElementById('editSponsorOrganization').value,
				contactName: document.getElementById('editSponsorContactName').value,
				email: document.getElementById('editSponsorEmail').value,
				phone: document.getElementById('editSponsorPhone').value,
				sponsorshipPackage: document.getElementById('editSponsorPackage').value
			};

			try {
				showLoading();
				const id = document.getElementById('editSponsorId').value;
				const response = await fetch(`${API_BASE}/admin/sponsors/${id}`, {
					method: 'PUT',
					headers: getAuthHeaders(),
					body: JSON.stringify(formData)
				});

				if (response.ok) {
					showAlert('Sponsor updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('editSponsorModal')).hide();
					loadSponsors();
				} else {
					throw new Error('Error updating sponsor');
				}
			} catch (error) {
				console.error('Error updating sponsor:', error);
				showAlert('Error updating sponsor', 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteSponsor(sponsorId) {
			if (!confirm('Are you sure you want to delete this sponsor?')) return;

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/admin/sponsors/${sponsorId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				if (response.ok) {
					showAlert('Sponsor deleted successfully', 'success');
					loadSponsors();
				} else {
					throw new Error('Error deleting sponsor');
				}
			} catch (error) {
				console.error('Error deleting sponsor:', error);
				showAlert('Error deleting sponsor', 'danger');
			} finally {
				hideLoading();
			}
		}

		// Analytics Functions
		async function loadAnalytics() {
			try {
				showLoading();
				// Load analytics data here
				showAlert('Analytics feature coming soon!', 'info');
			} catch (error) {
				console.error('Error loading analytics:', error);
				showAlert('Error loading analytics', 'danger');
			} finally {
				hideLoading();
			}
		}

		// Utility Functions
		function copyToClipboard(text) {
			navigator.clipboard.writeText(text).then(() => {
				showAlert('Copied to clipboard!', 'success');
			}).catch(() => {
				showAlert('Failed to copy to clipboard', 'danger');
			});
		}

		function exportData(dataType) {
			// Trigger DataTable export
			$(`#${dataType}Table`).DataTable().button('.buttons-csv').trigger();
		}

		function exportAdmins() {
			// Export admins as JSON
			const admins = currentData.admins || [];
			const dataStr = JSON.stringify(admins, null, 2);
			const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
			
			const exportFileDefaultName = 'admins_export.json';
			const linkElement = document.createElement('a');
			linkElement.setAttribute('href', dataUri);
			linkElement.setAttribute('download', exportFileDefaultName);
			linkElement.click();
		}

		function filterRegistrations(status) {
			let filteredData = currentData.registrations || [];
			
			if (status === 'paid') {
				filteredData = filteredData.filter(reg => reg.isPaid);
			} else if (status === 'pending') {
				filteredData = filteredData.filter(reg => !reg.isPaid);
			}
			
			displayRegistrations(filteredData);
		}

		// Committee Management Functions
		async function loadCommitteeMembers() {
			try {
				showLoading();
				console.log('Loading committee members with URL:', `${API_BASE}/reviewing-committee/members`);
				const response = await fetch(`${API_BASE}/reviewing-committee/members`, {
					headers: getAuthHeaders()
				});
				
				console.log('Committee response status:', response.status);
				
				if (!response.ok) {
					const errorText = await response.text();
					console.error('API Error:', response.status, errorText);
					throw new Error(`HTTP ${response.status}: ${errorText}`);
				}
				
				const result = await response.json();
				console.log('Committee members response:', result);
				
				if (result.success && result.data) {
					currentData.committeeMembers = result.data;
					displayCommitteeMembers(result.data);
				} else {
					console.error('Invalid response structure:', result);
					throw new Error('Invalid response format');
				}
				
				// Load committee stats
				loadCommitteeStats();
			} catch (error) {
				console.error('Error loading committee members:', error);
				showAlert(`Error loading committee members: ${error.message}`, 'danger');
			} finally {
				hideLoading();
			}
		}

		async function loadCommitteeStats() {
			try {
				console.log('Loading committee stats...');
				const response = await fetch(`${API_BASE}/reviewing-committee/stats`, {
					headers: getAuthHeaders()
				});
				
				if (!response.ok) {
					const errorText = await response.text();
					console.error('Stats API Error:', response.status, errorText);
					throw new Error(`HTTP ${response.status}: ${errorText}`);
				}
				
				const result = await response.json();
				console.log('Committee stats response:', result);
				
				if (result.success && result.data) {
					const stats = result.data;
					
					// Update committee counts
					document.getElementById('activeCommitteeCount').textContent = stats.committee?.active || 0;
					document.getElementById('totalCommitteeCount').textContent = stats.committee?.total || 0;
					document.getElementById('statsActiveMembers').textContent = stats.committee?.active || 0;
					
					// Update speaker review stats
					document.getElementById('statsPendingSpeakers').textContent = stats.speakers?.PENDING || 0;
					document.getElementById('statsUnderReview').textContent = (stats.speakers?.SENT_TO_COMMITTEE || 0) + (stats.speakers?.UNDER_REVIEW || 0);
					document.getElementById('statsApproved').textContent = stats.speakers?.APPROVED || 0;
				} else {
					console.error('Invalid stats response structure:', result);
					// Set default values
					document.getElementById('activeCommitteeCount').textContent = '0';
					document.getElementById('totalCommitteeCount').textContent = '0';
					document.getElementById('statsActiveMembers').textContent = '0';
					document.getElementById('statsPendingSpeakers').textContent = '0';
					document.getElementById('statsUnderReview').textContent = '0';
					document.getElementById('statsApproved').textContent = '0';
				}
			} catch (error) {
				console.error('Error loading committee stats:', error);
				// Set default values on error
				document.getElementById('activeCommitteeCount').textContent = '0';
				document.getElementById('totalCommitteeCount').textContent = '0';
				document.getElementById('statsActiveMembers').textContent = '0';
				document.getElementById('statsPendingSpeakers').textContent = '0';
				document.getElementById('statsUnderReview').textContent = '0';
				document.getElementById('statsApproved').textContent = '0';
			}
		}

		function displayCommitteeMembers(members) {
			console.log('Displaying committee members:', members);
			console.log('Number of members:', members ? members.length : 0);
			
			if ($.fn.DataTable.isDataTable('#committeeTable')) {
				$('#committeeTable').DataTable().destroy();
			}

			$('#committeeTable').DataTable({
				data: members,
				columns: [
					{ data: 'name' },
					{ data: 'email' },
					{ data: 'designation' },
					{ data: 'institution' },
					{ data: 'expertise' },
					{ 
						data: 'isActive',
						render: function(data) {
							return data ? '<span class="badge bg-success">Active</span>' : '<span class="badge bg-secondary">Inactive</span>';
						}
					},
					{ 
						data: 'createdAt',
						render: function(data) {
							return new Date(data).toLocaleDateString();
						}
					},
					{
						data: null,
						render: function(data, type, row) {
							return `
								<div class="btn-group">
									<button class="btn btn-sm btn-outline-primary" onclick="editCommitteeMember('${row.id}')" title="Edit">
										<i class="fas fa-edit"></i>
									</button>
									<button class="btn btn-sm btn-outline-danger" onclick="deleteCommitteeMember('${row.id}')" title="Delete">
										<i class="fas fa-trash"></i>
									</button>
								</div>
							`;
						}
					}
				],
				responsive: true,
				pageLength: 25,
				order: [[0, 'asc']], // Sort by name
				dom: 'Bfrtip',
				buttons: [
					{
						extend: 'csv',
						text: '<i class="fas fa-download"></i> CSV',
						className: 'btn btn-success btn-sm'
					}
				]
			});
		}

		async function createCommitteeMember() {
			const formData = {
				name: document.getElementById('committeeName').value,
				email: document.getElementById('committeeEmail').value,
				designation: document.getElementById('committeeDesignation').value,
				institution: document.getElementById('committeeInstitution').value,
				expertise: document.getElementById('committeeExpertise').value,
				phone: document.getElementById('committeePhone').value
			};

			// Validation
			if (!formData.name || !formData.email || !formData.designation || !formData.institution || !formData.expertise) {
				showAlert('Please fill in all required fields', 'warning');
				return;
			}

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/reviewing-committee/members`, {
					method: 'POST',
					headers: getAuthHeaders(),
					body: JSON.stringify(formData)
				});

				const result = await response.json();
				if (response.ok) {
					showAlert('Committee member created successfully', 'success');
					document.getElementById('createCommitteeForm').reset();
					bootstrap.Modal.getInstance(document.getElementById('createCommitteeModal')).hide();
					loadCommitteeMembers();
				} else {
					throw new Error(result.message || 'Error creating committee member');
				}
			} catch (error) {
				console.error('Error creating committee member:', error);
				showAlert(error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		function editCommitteeMember(memberId) {
			const member = currentData.committeeMembers.find(m => m.id === memberId);
			if (!member) return;

			// Populate form fields
			document.getElementById('editCommitteeId').value = member.id;
			document.getElementById('editCommitteeName').value = member.name;
			document.getElementById('editCommitteeEmail').value = member.email;
			document.getElementById('editCommitteeDesignation').value = member.designation;
			document.getElementById('editCommitteeInstitution').value = member.institution;
			document.getElementById('editCommitteeExpertise').value = member.expertise;
			document.getElementById('editCommitteePhone').value = member.phone || '';
			document.getElementById('editCommitteeStatus').value = member.isActive.toString();

			new bootstrap.Modal(document.getElementById('editCommitteeModal')).show();
		}

		async function updateCommitteeMember() {
			const formData = {
				name: document.getElementById('editCommitteeName').value,
				email: document.getElementById('editCommitteeEmail').value,
				designation: document.getElementById('editCommitteeDesignation').value,
				institution: document.getElementById('editCommitteeInstitution').value,
				expertise: document.getElementById('editCommitteeExpertise').value,
				phone: document.getElementById('editCommitteePhone').value,
				isActive: document.getElementById('editCommitteeStatus').value === 'true'
			};

			try {
				showLoading();
				const id = document.getElementById('editCommitteeId').value;
				const response = await fetch(`${API_BASE}/reviewing-committee/members/${id}`, {
					method: 'PUT',
					headers: getAuthHeaders(),
					body: JSON.stringify(formData)
				});

				const result = await response.json();
				if (response.ok) {
					showAlert('Committee member updated successfully', 'success');
					bootstrap.Modal.getInstance(document.getElementById('editCommitteeModal')).hide();
					loadCommitteeMembers();
				} else {
					throw new Error(result.message || 'Error updating committee member');
				}
			} catch (error) {
				console.error('Error updating committee member:', error);
				showAlert(error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		async function deleteCommitteeMember(memberId) {
			if (!confirm('Are you sure you want to delete this committee member? This action cannot be undone.')) return;

			try {
				showLoading();
				const response = await fetch(`${API_BASE}/reviewing-committee/members/${memberId}`, {
					method: 'DELETE',
					headers: getAuthHeaders()
				});

				const result = await response.json();
				if (response.ok) {
					showAlert('Committee member deleted successfully', 'success');
					loadCommitteeMembers();
				} else {
					throw new Error(result.message || 'Error deleting committee member');
				}
			} catch (error) {
				console.error('Error deleting committee member:', error);
				showAlert(error.message, 'danger');
			} finally {
				hideLoading();
			}
		}

		function exportCommitteeMembers() {
			// Export committee members as CSV using DataTable
			$('#committeeTable').DataTable().button('.buttons-csv').trigger();
		}

		function logout() {
			localStorage.removeItem('adminToken');
			window.location.href = 'index.html';
		}
	</script>
</body>

</html>
</html>